# Timeshift-AutoBackup-systemd: Automated Linux Snapshots

![Systemd](https://img.shields.io/badge/systemd-%23E44D30.svg?logo=systemd&logoColor=white)
![Timeshift](https://img.shields.io/badge/Timeshift-1793D1?logo=timeshift&logoColor=white)
![Shell](https://img.shields.io/badge/Shell-Script-%234EAA25)

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ **Timeshift** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **systemd timers**. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

‚úî –ì–æ—Ç–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ systemd (—Å–µ—Ä–≤–∏—Å + —Ç–∞–π–º–µ—Ä)  
‚úî –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–∫—ç—à–∏, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, Docker)
‚úî –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –Ω–∞ –¥—Ä—É–≥–∏–µ —Ä–∞–∑–¥–µ–ª—ã –¥–∏—Å–∫–æ–≤
‚úî –ì–∏–±–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ/–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ/–µ–∂–µ–º–µ—Å—è—á–Ω–æ) —Å–Ω–∏–º–∫–æ–≤
‚úî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å systemd-journald –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è  


## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Timeshift (`sudo apt install timeshift`)
- Systemd (–≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: 
```bash
git clone https://github.com/yourusername/timeshift-autobackup-systemd.git
cd timeshift-autobackup-systemd
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ü–µ–ª–µ–≤–æ–π –¥–∏—Å–∫ –¥–ª—è –±—ç–∫–∞–ø–æ–≤:
> **–í–∞–∂–Ω–æ**: –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–º–µ–Ω–∏—Ç–µ UUID –≤ —Å—Ç—Ä–æ–∫–µ backup_device_uuid –≤ `timeshift.json` –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (`sudo blkid`)
```bash
sudo blkid  # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ UUID –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
vim etc/timeshift/timeshift.json
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
sudo cp -v ~/timeshift-autobackup-systemd/timeshift.* /etc/systemd/system/
sudo cp -v ~/timeshift-autobackup-systemd/timeshift.json /etc/timeshift/
```

- `etc/systemd/system/timeshift.service` - unit –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–Ω–∏–º–∫–æ–≤
- `etc/systemd/system/timeshift.timer` - unit —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 18:00)
- `etc/timeshift/timeshift.json` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Timeshift (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:
```ini
# –í timeshift.timer
OnCalendar=*-*-* 04:00:00  # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 4:00
```

4. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
systemd-analyze verify /etc/systemd/system/timeshift.*
```
–ï—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ—Ç, –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–≤–µ–¥–µ—Ç –Ω–∏—á–µ–≥–æ –∏–ª–∏ –≤—ã–≤–µ–¥–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ systemd –¥–ª—è unit-—Ñ–∞–π–ª–æ–≤ (.service –∏–ª–∏ .timer):
```bash
sudo systemctl daemon-reload
```
> **–í–∞–∂–Ω–æ**: –ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω—è–ª–∏ unit-—Ñ–∞–π–ª—ã, –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å systemd.

6. –ó–∞–ø—É—Å–∫ unit-—Ñ–∞–π–ª–æ–≤, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã:
```bash
sudo systemctl start timeshift.timer
sudo systemctl enable timeshift.timer
```

7. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å—Ç–∏–ª—Å—è:
```bash
systemctl status timeshift.timer
```
–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤ —Å—Ç—Ä–æ–∫–µ Loaded: enabled, –≤ Active: active (waiting)

## üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–Ω–∏–º–∫–∞–º–∏

### –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–∞
```bash
sudo timeshift --create --comments "–†—É—á–Ω–æ–π —Å–Ω–∏–º–æ–∫"
```
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –±—ç–∫–∞–ø—ã –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏—Å–∫–µ: /timeshift. 
–ï—Å–ª–∏ –ø–∞–ø–∫–∏ –Ω–µ—Ç, TimeShift —Å–æ–∑–¥–∞—Å—Ç –µ—ë –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –±—ç–∫–∞–ø–µ.
–≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: /timeshift/snapshots/2025-07-28_17-56-16/exclude.list
—Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è —Ñ–∞–π–ª "exclude.list" –≥–¥–µ –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫–∏–µ —Ä–∞–∑–¥–µ–ª—ã –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ —Å–Ω–∏–º–æ–∫.


### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–Ω–∏–º–∫–æ–≤
```bash
sudo timeshift --list
# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
# Device: /dev/sdb1 (ext4, 500GB)
# Snapshot | Tag    | Date                | Size
# -------- | ------ | ------------------- | -----
# 1        | D      | 2025-08-01 18:00:01 | 15GB
```

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–Ω–∏–º–∫–æ–≤
```bash
# –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–Ω–∏–º–æ–∫
sudo timeshift --delete --snapshot '2025-07-30_14-34-03'

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ (–ø–æ –ø–æ–ª–∏—Ç–∏–∫–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è)
sudo timeshift --cleanup
```


## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
–õ–æ–≥–∏ —Ç–æ–ª—å–∫–æ —Ç–∞–π–º–µ—Ä–∞ (–∑–∞–ø—É—Å–∫–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
```bash
sudo journalctl -u timeshift.timer
```

–õ–æ–≥–∏ —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–∞ (–ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–∞)
```bash
sudo journalctl -u timeshift.service
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
.
‚îú‚îÄ‚îÄ etc/
‚îÇ ‚îú‚îÄ‚îÄ systemd/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ system/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ timeshift.service
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ timeshift.timer
‚îÇ ‚îî‚îÄ‚îÄ timeshift/
‚îÇ ‚îî‚îÄ‚îÄ timeshift.json
‚îú‚îÄ‚îÄ timeshift/snapshots/ # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–Ω–∏–º–∫–æ–≤ –Ω–∞ –¥–∏—Å–∫–µ
‚îî‚îÄ‚îÄ readme.md
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å–æ –º–Ω–æ–π –ø–æ –∞–¥—Ä–µ—Å—É: rusov63@yahoo.com

